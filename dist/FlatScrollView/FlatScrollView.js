var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _AnimatedFocusableHighlight=require("../focusable/AnimatedFocusableHighlight");var _FlatScrollViewDefaultStyle=require("../styles/FlatScrollViewDefaultStyle.style");var _AnimatedBorderFocusableHighlight=require("../focusable/AnimatedBorderFocusableHighlight");var _FlatScrollViewItem=_interopRequireDefault(require("../items/FlatScrollViewItem"));var _useMediaList3=require("../utils/useMediaList");var _TVAPPContext=_interopRequireDefault(require("../TVAPPContext"));var _tools=require("../utils/tools");var _this=this,_jsxFileName="/Users/rinaldo/Documents/React-native/npm-package/RTSAppTv/src/lib/FlatScrollView/FlatScrollView.js";function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!=="object"&&typeof obj!=="function"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}var FlatScrollView=function FlatScrollView(_ref){var id=_ref.id,rowData=_ref.rowData,onItemPress=_ref.onItemPress;var _useMediaList=(0,_useMediaList3.useMediaList)(rowData),_useMediaList2=(0,_slicedToArray2.default)(_useMediaList,2),mediaList=_useMediaList2[0],loading=_useMediaList2[1];var _useContext=(0,_react.useContext)(_TVAPPContext.default),FocusManager=_useContext.FocusManager,Theme=_useContext.Theme;var theme=Theme.theme;var style=(0,_extends2.default)({},_FlatScrollViewDefaultStyle.FlatScrollViewDefaultStyle,theme==null?void 0:theme.Typography,theme.FlatScrollView);var _useState=(0,_react.useState)({}),_useState2=(0,_slicedToArray2.default)(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=(0,_react.useState)(FocusManager.getFocus().type),_useState4=(0,_slicedToArray2.default)(_useState3,2),focusType=_useState4[0],setFocusType=_useState4[1];var flatListRef=(0,_react.createRef)();var rowRefs=(0,_react.useRef)([]);(0,_react.useEffect)(function(){try{if(Array.isArray(rowData)){setData(rowData[0]);}else{setData(rowData);}}catch(e){console.log('ERROR - FlatScrollView data',e);}},[rowData]);(0,_react.useEffect)(function(){setFocusType(FocusManager.getFocus().type);return function(){};},[FocusManager.getFocus().type]);var getRef=(0,_react.useCallback)(function(index){return function(ref){rowRefs.current[index]=ref;};},[]);var _onPress=(0,_react.useCallback)(function(item){if(onItemPress){onItemPress(item);}},[]);var _onFocus=function onFocus(index){if(index%4===3){rowRefs.current[index].setNativeProps({nextFocusRight:(0,_reactNative.findNodeHandle)(rowRefs.current[index])});}if(index%4===0){rowRefs.current[index].setNativeProps({nextFocusLeft:(0,_reactNative.findNodeHandle)(rowRefs.current[index])});}};var getFocusableProps=function getFocusableProps(item,index){return{ref:getRef(index),onPress:function onPress(){return _onPress(item);},onFocus:function onFocus(){return _onFocus(index);},underlayColor:style.buttonFocusedColor,style:style.rowItem};};var buildSwimLaneScale=function buildSwimLaneScale(){return mediaList.map(function(item,index){var imageUrl=item.imageUrl,isEventStarted=item.isEventStarted,prettyHour=item.prettyHour,prettyDuration=item.prettyDuration,bait=item.bait,title=item.title,description=item.description;var key=id+"_"+index;return _react.default.createElement(_AnimatedFocusableHighlight.AnimatedFocusableHighlight,(0,_extends2.default)({key:key,nativeID:key},getFocusableProps(item,index),{__self:_this,__source:{fileName:_jsxFileName,lineNumber:85,columnNumber:20}}),(0,_tools.getClonedRenderItem)(_react.default.createElement(_FlatScrollViewItem.default,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:86,columnNumber:38}}),{key:index,imageUrl:imageUrl,isEventStarted:isEventStarted,prettyHour:prettyHour,prettyDuration:prettyDuration,bait:bait,title:title,description:description,theme:theme}));});};var buildSwimLaneBorder=function buildSwimLaneBorder(){return mediaList.map(function(item,index){var imageUrl=item.imageUrl,isEventStarted=item.isEventStarted,prettyHour=item.prettyHour,prettyDuration=item.prettyDuration,bait=item.bait,title=item.title,description=item.description;var key=id+"_"+index;return _react.default.createElement(_AnimatedBorderFocusableHighlight.AnimatedBorderFocusableHighlight,(0,_extends2.default)({key:key,nativeID:key},getFocusableProps(item,index),{__self:_this,__source:{fileName:_jsxFileName,lineNumber:95,columnNumber:20}}),(0,_tools.getClonedRenderItem)(_react.default.createElement(_FlatScrollViewItem.default,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:96,columnNumber:38}}),{key:index,imageUrl:imageUrl,isEventStarted:isEventStarted,prettyHour:prettyHour,prettyDuration:prettyDuration,bait:bait,title:title,description:description,theme:theme}));});};return _react.default.createElement(_reactNative.View,{style:style.row,ref:flatListRef,__self:_this,__source:{fileName:_jsxFileName,lineNumber:102,columnNumber:9}},data.title&&_react.default.createElement(_reactNative.View,{style:style.title_container,__self:_this,__source:{fileName:_jsxFileName,lineNumber:103,columnNumber:28}},_react.default.createElement(_reactNative.Text,{style:style.swimlaneHeaderText1,__self:_this,__source:{fileName:_jsxFileName,lineNumber:104,columnNumber:17}},data.title)),!loading&&_react.default.createElement(_reactNative.View,{style:style.list,__self:_this,__source:{fileName:_jsxFileName,lineNumber:106,columnNumber:26}},!loading&&focusType==='border'?buildSwimLaneBorder():buildSwimLaneScale()));};var _default=(0,_react.memo)(FlatScrollView);exports.default=_default;